// QuestionForm.jsx
import React, { useEffect } from 'react';
import { useForm, useFieldArray } from 'react-hook-form';
import { FaPlus } from 'react-icons/fa';

const QuestionForm = ({ onSubmit, selectedQuestion, setSelectedQuestion }) => {
  const { handleSubmit, register, control, setValue, reset } = useForm();
  const { fields, append, remove } = useFieldArray({
    control,
    name: 'variations',
  });

  useEffect(() => {
    if (selectedQuestion !== null) {
      setValue('mainQuestion', selectedQuestion.mainQuestion);
      setValue('answer', selectedQuestion.answer);
      setValue('actionToRun', selectedQuestion.actionToRun);

      // Clear existing variations
      while (fields.length > 0) {
        remove(0);
      }

      if (selectedQuestion.variations) {
        selectedQuestion.variations.forEach((variation) => {
          append({ variationList: variation.variationList });
        });
      }
    } else {
      reset();
    }
  }, [selectedQuestion, append, fields, remove, setValue, reset]);

  const handleReset = () => {
    reset();
    setSelectedQuestion(null);
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="mt-8">
      {/* Form fields go here... */}

      <button
        type="button"
        className="bg-gray-500 text-white p-2 mx-1"
        onClick={handleReset}
      >
        Reset
      </button>
      <button type="submit" className="bg-blue-500 text-white p-2 mx-1">
        Submit
      </button>
    </form>
  );
};

export default QuestionForm;

// EditQuestionForm.jsx
import React from 'react';
import { useForm } from 'react-hook-form';

const EditQuestionForm = ({ onSubmit, selectedQuestion, onCancel }) => {
  const { handleSubmit, register, setValue, reset } = useForm();

  React.useEffect(() => {
    if (selectedQuestion) {
      setValue('mainQuestion', selectedQuestion.mainQuestion);
      setValue('answer', selectedQuestion.answer);
      setValue('actionToRun', selectedQuestion.actionToRun);

      // Clear existing variations
      setValue('variations', []);

      if (selectedQuestion.variations) {
        selectedQuestion.variations.forEach((variation) => {
          setValue('variations', (prevVariations) => [
            ...prevVariations,
            { variationList: variation.variationList },
          ]);
        });
      }
    }
  }, [selectedQuestion, setValue]);

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="mt-8">
      {/* Form fields go here... */}

      <button
        type="button"
        className="bg-gray-500 text-white p-2 mx-1"
        onClick={() => onCancel()}
      >
        Cancel
      </button>
      <button type="submit" className="bg-blue-500 text-white p-2 mx-1">
        Save Changes
      </button>
    </form>
  );
};

export default EditQuestionForm;
